<%= turbo_frame_tag "people_list" do %>
  <% if people.any? %>
    <!-- Desktop Table View -->
    <div class="hidden md:block bg-white shadow-md rounded-lg overflow-hidden">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">SSN</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">City, State</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Created</th>
            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <% people.each do |person| %>
            <%= render PersonCardComponent.new(person: person) %>
          <% end %>
        </tbody>
      </table>
    </div>

    <!-- Mobile Card View -->
    <div class="md:hidden space-y-4">
      <% people.each do |person| %>
        <div class="bg-white shadow rounded-lg p-4 hover:shadow-lg transition">
          <div class="flex items-start justify-between mb-3">
            <div class="flex items-center">
              <div class="flex-shrink-0 h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center">
                <span class="text-blue-600 font-semibold"><%= person.initials %></span>
              </div>
              <div class="ml-3">
                <h3 class="text-lg font-semibold text-gray-900"><%= person.full_name %></h3>
                <p class="text-xs text-gray-500"><%= person.has_middle_name? ? "With middle name" : "No middle name" %></p>
              </div>
            </div>
          </div>
          
          <dl class="space-y-2 text-sm">
            <div class="flex justify-between">
              <dt class="text-gray-500">SSN:</dt>
              <dd class="font-mono text-gray-900"><%= person.masked_ssn %></dd>
            </div>
            <div class="flex justify-between">
              <dt class="text-gray-500">Location:</dt>
              <dd class="text-gray-900"><%= person.city %>, <%= person.state %></dd>
            </div>
            <div class="flex justify-between">
              <dt class="text-gray-500">Created:</dt>
              <dd class="text-gray-900"><%= person.formatted_created_at %></dd>
            </div>
          </dl>
          
          <div class="mt-4 flex gap-2 justify-center">
            <%= link_to person, 
                data: { turbo_frame: "_top" }, 
                class: "flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-lg transition", 
                title: "View", 
                aria: { label: "View details" } do %>
              <i class="ph ph-eye text-2xl"></i>
            <% end %>
            <%= link_to edit_person_path(person), 
                data: { turbo_frame: "_top" }, 
                class: "flex items-center justify-center bg-green-600 hover:bg-green-700 text-white p-3 rounded-lg transition", 
                title: "Edit", 
                aria: { label: "Edit record" } do %>
              <i class="ph ph-pencil-simple text-2xl"></i>
            <% end %>
            <%= link_to "#",
                data: { 
                  controller: "delete-button",
                  delete_button_url_value: person_path(person),
                  delete_button_method_value: "delete",
                  action: "click->delete-button#openModal"
                },
                class: "flex items-center justify-center bg-red-600 hover:bg-red-700 text-white p-3 rounded-lg transition",
                title: "Delete",
                aria: { label: "Delete record" } do %>
              <i class="ph ph-trash text-2xl"></i>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="mt-4 text-sm text-gray-600">
      Showing <%= people.count %> <%= "record".pluralize(people.count) %>
    </div>
  <% else %>
    <%= render EmptyStateComponent.new(
      title: "No PII records",
      description: "Get started by creating a new PII record.",
      action_text: "New PII Record",
      action_path: new_person_path
    ) %>
  <% end %>
<% end %>

